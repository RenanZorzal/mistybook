<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/icon/favicon.ico" type="image/x-icon">
    <title>MistyBook</title>
    <link rel="stylesheet" href="../css/navbar.css">
    <link rel="stylesheet" href="../css/grid.css">
    <link rel="stylesheet" href="../css/categorias.css">
    <link rel="stylesheet" href="../css/carrinho.css">
</head>
<body>
  <header>
        <div class="navbar">
          <div class="left-section">
            <div class="logo" >
              <a href="../index.html">
              <img src="../images/Logovetor.png" alt="Logo" style="width: 100px; height: 80px;">
              <p class="nomePrincipal">MistyBook</p></a>
            </div>
          </div>
          
          <div class="search-box">
            <input type="text" placeholder="Buscar livro">
            <span class="icon">üîç</span>
          </div>
      
          <div class="right-section">
            <a href="../pages/mapa.html"><div class="icon-button"><img src="https://cdn-icons-png.flaticon.com/512/2838/2838912.png" alt="Localiza√ß√£o"></div></a>
            <div class="dropdown">
          <div class="icon-button dropdown-toggle" onclick="toggleDropdown()">
            <img src="../images/iconCategorias/sacola.png" alt="Sacola">
          </div>
          <div id="dropdown-menu" class="dropdown-menu">
            <a href="../pages/meuanuncios.html">Meus An√∫ncios</a>
            <a href="../pages/minhascompras.html">Minhas Compras</a>
          </div>
        </div>
<script>
          function toggleDropdown() {
            document.getElementById("dropdown-menu").classList.toggle("show");
          }

          // Fecha o dropdown se clicar fora dele
          window.onclick = function (event) {
            if (!event.target.closest('.dropdown')) {
              document.getElementById("dropdown-menu").classList.remove("show");
            }
          };
           function toggleProfileDropdown() {
    document.getElementById("profile-dropdown-menu").classList.toggle("show");
  }

  // Fecha os dropdowns se clicar fora
  window.onclick = function (event) {
    if (!event.target.closest('.dropdown')) {
      document.getElementById("dropdown-menu").classList.remove("show");
      document.getElementById("profile-dropdown-menu").classList.remove("show");
    }
  };
        </script>
            <a href="#"><div class="icon-button"><img src="https://cdn-icons-png.flaticon.com/512/2950/2950714.png" alt="Chat"></div></a>
            <a href="#"><div class="icon-button"><img src="https://cdn-icons-png.flaticon.com/512/2645/2645897.png" alt="Notifica√ß√µes"></div></a>
            <a href="#">
          <div class="icon-button"><img src="../images/iconCategorias/carrinho.png" alt="Carrinho">
          </div>
        </a>
            <div class="dropdown">
  <div class="icon-button dropdown-toggle" onclick="toggleProfileDropdown()">
    <img src="../images/iconCategorias/perfil.png" alt="Perfil">
  </div>
  <div id="profile-dropdown-menu" class="dropdown-menu">
    <a href="../pages/login/login.html">Login</a>
    <a href="../pages/login/cadastro.html">Registre-se</a>
    <a href="../pages/perfil.html">Meu Perfil</a>
  </div>
</div>
          </div>
        </div>
      
          <div class="subnavbar">
    <a href="../pages/categorias/romance.html">Romance</a>
    <a href="../pages/categorias/fantasia.html">Fantasia</a>
    <a href="../pages/categorias/terror.html">Terror</a>
    <a href="../pages/categorias/quadrinhos.html">Quadrinhos</a>
    <a href="../pages/categorias/religioso.html">Religioso</a>
    <a href="../pages/categorias/negocios.html">Neg√≥cios</a>
    <a href="../pages/categorias/ficcao.html">Fic√ß√£o</a>
    <a href="../pages/categorias/educacao.html">Educa√ß√£o</a>
  </div>
      </header>

  <h2 style="text-align: center;">Carrinho de Compras</h2>
  <div style="display: flex; justify-content: center;">
  <div id="carrinho-container" style="width: 40%;"></div>
  </div>
  <div style="display: flex; justify-content: center;">
  <button id="finalizar" onclick="finalizarCompra()" style="width: 10%;">Finalizar Compra</button>
  </div>

<script>
  const container = document.getElementById('carrinho-container');
  let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];

  function calcularTotal() {
    return carrinho.reduce((total, item) => {
      const preco = parseFloat(item.preco.replace('R$', '').replace(',', '.'));
      return total + preco;
    }, 0).toFixed(2);
  }

  function renderCarrinho() {
    container.innerHTML = '';

    if (carrinho.length === 0) {
      container.innerHTML = '<p style="text-align:center;">Seu carrinho est√° vazio.</p>';
      document.getElementById('finalizar').style.display = 'none';
      return;
    }

    carrinho.forEach((item, index) => {
      const div = document.createElement('div');
      div.className = 'carrinho-item';
      div.innerHTML = `
        <img src="${item.imagem}" alt="${item.titulo}">
        <div class="info-item">
          <strong>${item.titulo}</strong>
          <span>${item.preco}</span>
        </div>
        <button class="btn-remover" onclick="removerItem(${index})">Remover</button>
      `;
      container.appendChild(div);
    });

    // Mostra o valor total abaixo dos itens
    const total = calcularTotal();
    const totalDiv = document.createElement('div');
    totalDiv.style.textAlign = 'center';
    totalDiv.style.marginTop = '20px';
    totalDiv.innerHTML = `<strong>Total: R$ ${total.replace('.', ',')}</strong>`;
    container.appendChild(totalDiv);

    document.getElementById('finalizar').style.display = 'inline-block';
  }

  function removerItem(i) {
    carrinho.splice(i, 1);
    localStorage.setItem('carrinho', JSON.stringify(carrinho));
    renderCarrinho();
  }

  function finalizarCompra() {
    alert("Compra finalizada com sucesso!");
    localStorage.removeItem('carrinho');
    carrinho = [];
    renderCarrinho();
  }

  renderCarrinho();
</script>

</body>
</html>
